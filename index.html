<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Njabulo Jb Tech - Ultimate Downloader</title>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #007bff;
            --terminal-bg: #000000;
            --text-green: #00ff00;
            --text-red: #ff3131;
            --text-blue: #00e5ff;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: white; /* WHITE BACKGROUND */
            margin: 0; padding: 0; color: #333;
        }

        /* HEADER */
        #mainHeader {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 5%; background: #f8f9fa; border-bottom: 2px solid #eee;
        }

        .logo { font-size: 1.3rem; font-weight: bold; color: #111; text-decoration: none; display: flex; align-items: center; gap: 10px; }
        .status-box { display: flex; align-items: center; gap: 8px; background: #fff; padding: 5px 15px; border-radius: 20px; border: 1px solid #ddd; font-size: 13px; }
        .pulse-dot { width: 10px; height: 10px; background-color: #2ecc71; border-radius: 50%; animation: pulse 1.5s infinite; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(46, 204, 113, 0); }
            100% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
        }

        /* CONTAINER */
        .container { max-width: 900px; margin: 30px auto; padding: 20px; }
        .title_bg { background: #ffffff; border: 1px solid #eee; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); text-align: center; }

        /* GRID */
        .platform-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap: 10px; margin-bottom: 25px; }
        .p-btn { background: #f9f9f9; border: 1px solid #ddd; padding: 12px 5px; border-radius: 10px; cursor: pointer; font-size: 11px; font-weight: bold; display: flex; flex-direction: column; align-items: center; gap: 6px; transition: 0.3s; }
        .p-btn i { font-size: 1.3rem; color: #555; }
        .p-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
        .p-btn.active i { color: white; }

        /* ALERT BOX STYLE */
        .alert { background: #f1f8ff; color: #0052cc; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #cce4ff; display: flex; align-items: center; justify-content: center; gap: 10px; font-weight: 500; }

        /* INPUTS */
        input[type="text"] { width: 100%; padding: 16px; border: 2px solid #ddd; border-radius: 12px; font-size: 1rem; margin-bottom: 15px; box-sizing: border-box; outline: none; }
        
        /* FORMAT SELECTOR (AUDIO/VIDEO) */
        .format-selector { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .format-selector label { font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 5px; }

        /* BUTTONS */
        .action-btns { display: flex; gap: 15px; justify-content: center; margin-bottom: 30px; }
        .btn-main { padding: 14px 28px; border-radius: 10px; border: none; color: white; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.3s; }
        .btn-view { background: #4b5563; }
        .btn-download { background: #dc2626; }
        .btn-main:hover { transform: translateY(-3px); }

        /* TERMINAL */
        .terminal { background: var(--terminal-bg); color: white; padding: 20px; border-radius: 12px; font-family: 'Courier New', monospace; text-align: left; font-size: 13px; display: none; border-top: 4px solid var(--primary); }
        .term-header { color: #555; border-bottom: 1px solid #222; padding-bottom: 8px; margin-bottom: 12px; }
        .term-row { margin: 6px 0; }
        .label { color: var(--text-blue); }
        #log_output { margin-top: 15px; border-top: 1px dashed #333; padding-top: 10px; max-height: 120px; overflow-y: auto; }
        .log-noti { color: var(--text-green); }
        .log-err { color: var(--text-red); }
    </style>
</head>
<body>

<header id="mainHeader">
    <a href="#" class="logo"><i class="fab fa-github"></i> Njabulo Jb Tech</a>
    <div class="status-box">
        <div class="pulse-dot"></div>
        <span>Online</span>
    </div>
</header>

<div class="container">
    <div class="title_bg">
        <!-- PLATFORM GRID -->
        <div class="platform-grid">
            <button class="p-btn active" onclick="changePlat('youtube', 'YouTube')"><i class="fab fa-youtube"></i> YouTube</button>
            <button class="p-btn" onclick="changePlat('facebook', 'Facebook')"><i class="fab fa-facebook"></i> Facebook</button>
            <button class="p-btn" onclick="changePlat('tiktok', 'TikTok')"><i class="fab fa-tiktok"></i> TikTok</button>
            <button class="p-btn" onclick="changePlat('instagram', 'Instagram')"><i class="fab fa-instagram"></i> Instagram</button>
            <button class="p-btn" onclick="changePlat('spotify', 'Spotify')"><i class="fab fa-spotify"></i> Spotify</button>
            <button class="p-btn" onclick="changePlat('capcut', 'CapCut')"><i class="fas fa-video"></i> CapCut</button>
            <button class="p-btn" onclick="changePlat('pinterest', 'Pinterest')"><i class="fab fa-pinterest"></i> Pinterest</button>
            <button class="p-btn" onclick="changePlat('twitter', 'Twitter')"><i class="fab fa-twitter"></i> Twitter</button>
        </div>

        <!-- ALERT -->
        <div class="alert" id="alert_box">
            <i class="fas fa-info-circle"></i> Please enter URL YouTube bellow
        </div>

        <input type="text" id="url_input" placeholder="Paste link here...">

        <!-- AUDIO OR VIDEO CHOICE -->
        <div class="format-selector">
            <label><input type="radio" name="format" value="video" checked> <i class="fas fa-video"></i> Video</label>
            <label><input type="radio" name="format" value="audio"> <i class="fas fa-music"></i> Audio (MP3)</label>
        </div>

        <!-- ACTIONS -->
        <div class="action-btns">
            <button class="btn-main btn-view" onclick="process('view')">
                <i class="fab fa-searchengin"></i> View Link
            </button>
            <button class="btn-main btn-download" onclick="process('download')">
                <i class="fab fa-download"></i> Download
            </button>
        </div>

        <!-- TERMINAL -->
        <div class="terminal" id="terminal">
            <div class="term-header">NJABULO-TECH DOWNLOAD MANAGER</div>
            <div class="term-row"><span class="label">[TITLE]:</span> <span id="t_title">---</span></div>
            <div class="term-row"><span class="label">[TIME TAKEN]:</span> <span id="t_time">0s</span></div>
            <div class="term-row"><span class="label">[MINUTES]:</span> <span id="t_min">--</span></div>
            <div id="log_output"></div>
        </div>
    </div>
</div>

<script>
    const apis = {
        tiktok: 'https://prenivapi.vercel.app/api/tiktok?url=',
        facebook: 'https://prenivapi.vercel.app/api/facebookv1?url=',
        instagram: 'https://prenivapi.vercel.app/api/igdl?url=',
        youtube: 'https://prenivapi.vercel.app/api/youtube?url=',
        spotify: 'https://prenivapi.vercel.app/api/spotify?url=',
        capcut: 'https://prenivapi.vercel.app/api/capcut?url=',
        pinterest: 'https://prenivapi.vercel.app/api/pinterest?url=',
        twitter: 'https://prenivapi.vercel.app/api/twitter?url='
    };

    let selectedPlat = 'youtube';
    let timer;

    function changePlat(key, name) {
        selectedPlat = key;
        document.getElementById('alert_box').innerHTML = `<i class="fas fa-info-circle"></i> Please enter URL ${name} bellow`;
        document.querySelectorAll('.p-btn').forEach(b => b.classList.remove('active'));
        event.currentTarget.classList.add('active');
    }

    function addLog(msg, type) {
        const out = document.getElementById('log_output');
        const div = document.createElement('div');
        div.className = `log-${type}`;
        div.innerHTML = `> ${msg}`;
        out.prepend(div);
    }

    async function process(mode) {
        const url = document.getElementById('url_input').value;
        const format = document.querySelector('input[name="format"]:checked').value;
        const term = document.getElementById('terminal');

        if (!url) {
            term.style.display = 'block';
            addLog("ERROR: Please paste a link first!", "err");
            return;
        }

        term.style.display = 'block';
        addLog(`Contacting ${selectedPlat} Servers...`, "info");
        
        let sec = 0;
        clearInterval(timer);
        timer = setInterval(() => {
            sec++;
            document.getElementById('t_time').innerText = sec + "s";
            document.getElementById('t_min').innerText = "Processing...";
        }, 1000);

        try {
            const res = await fetch(apis[selectedPlat] + encodeURIComponent(url));
            const data = await res.json();
            clearInterval(timer);

            // HANDLE API RESPONSE
            const result = data.result || data;
            const title = result.title || "Njabulo_Tech_File";
            
            // Logic to pick Audio or Video link
            let finalLink = "";
            if (format === 'audio') {
                finalLink = result.audio || result.mp3 || result.url;
            } else {
                finalLink = result.video || result.url || (result.hd ? result.hd : result.sd);
            }

            if (!finalLink) throw new Error("No download link found for this format.");

            document.getElementById('t_title').innerText = title;
            document.getElementById('t_min').innerText = "0 min";
            addLog("NOTIFICATION: Media File Captured!", "noti");

            if (mode === 'download') {
                addLog("NOTIFICATION: Sending to Chrome Storage...", "noti");
                const a = document.createElement('a');
                a.href = finalLink;
                a.download = title + (format === 'audio' ? ".mp3" : ".mp4");
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            } else {
                window.open(finalLink, '_blank');
            }

        } catch (e) {
            clearInterval(timer);
            addLog(`ERROR: ${e.message}`, "err");
        }
    }
</script>
</body>
</html>

